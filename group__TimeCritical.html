<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3-phase PV router: Time-critical functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">3-phase PV router
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Time-critical functions</div></div>
</div><!--header-->
<div class="contents">

<p>Functions used by the ISR.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gadc681bbd6c00b6c808ad999bc0e49542"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gadc681bbd6c00b6c808ad999bc0e49542">confirmPolarity</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:gadc681bbd6c00b6c808ad999bc0e49542"><td class="mdescLeft">&#160;</td><td class="mdescRight">Confirms the polarity of the current voltage sample for a specific phase.  <br /></td></tr>
<tr class="separator:gadc681bbd6c00b6c808ad999bc0e49542"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga05c2e5b588ced1cd7312f5b0edc5b295"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295">ISR</a> (ADC_vect)</td></tr>
<tr class="memdesc:ga05c2e5b588ced1cd7312f5b0edc5b295"><td class="mdescLeft">&#160;</td><td class="mdescRight">Interrupt Service Routine - Interrupt-Driven Analog Conversion.  <br /></td></tr>
<tr class="separator:ga05c2e5b588ced1cd7312f5b0edc5b295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8e7b88bb4b21554d23b57676a45e034e"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga8e7b88bb4b21554d23b57676a45e034e">nextLogicalLoadToBeAdded</a> ()</td></tr>
<tr class="memdesc:ga8e7b88bb4b21554d23b57676a45e034e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the next logical load that could be added.  <br /></td></tr>
<tr class="separator:ga8e7b88bb4b21554d23b57676a45e034e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabfb25288a79335282af6922e833d3c35"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gabfb25288a79335282af6922e833d3c35">nextLogicalLoadToBeRemoved</a> ()</td></tr>
<tr class="memdesc:gabfb25288a79335282af6922e833d3c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">Retrieve the next logical load that could be removed (in reverse order).  <br /></td></tr>
<tr class="separator:gabfb25288a79335282af6922e833d3c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaef29df3a6c44ea8477b816cbdf3005f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gaef29df3a6c44ea8477b816cbdf3005f3">proceedHighEnergyLevel</a> ()</td></tr>
<tr class="memdesc:gaef29df3a6c44ea8477b816cbdf3005f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the case when the energy level is high, potentially adding a load.  <br /></td></tr>
<tr class="separator:gaef29df3a6c44ea8477b816cbdf3005f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7ecb8f04a958d86156a6c95581f242d3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga7ecb8f04a958d86156a6c95581f242d3">proceedLowEnergyLevel</a> ()</td></tr>
<tr class="memdesc:ga7ecb8f04a958d86156a6c95581f242d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles the case when the energy level is low, potentially removing a load.  <br /></td></tr>
<tr class="separator:ga7ecb8f04a958d86156a6c95581f242d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe8420bd47cd08c6d0327d4dbed06414"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gafe8420bd47cd08c6d0327d4dbed06414">processCurrentRawSample</a> (const uint8_t phase, const int16_t rawSample)</td></tr>
<tr class="memdesc:gafe8420bd47cd08c6d0327d4dbed06414"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the current raw sample for the specified phase.  <br /></td></tr>
<tr class="separator:gafe8420bd47cd08c6d0327d4dbed06414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaabf10592d01250ef862370d26c5a382b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gaabf10592d01250ef862370d26c5a382b">processDataLogging</a> ()</td></tr>
<tr class="memdesc:gaabf10592d01250ef862370d26c5a382b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process data logging at the end of each logging period.  <br /></td></tr>
<tr class="separator:gaabf10592d01250ef862370d26c5a382b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21380cdbe3f783dad431ff1a912cbaa1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga21380cdbe3f783dad431ff1a912cbaa1">processLatestContribution</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:ga21380cdbe3f783dad431ff1a912cbaa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the latest contribution after each phase-specific new cycle.  <br /></td></tr>
<tr class="separator:ga21380cdbe3f783dad431ff1a912cbaa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7449a97209a4b56151de6fc5197a9daf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga7449a97209a4b56151de6fc5197a9daf">processMinusHalfCycle</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:ga7449a97209a4b56151de6fc5197a9daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the start of a new negative half cycle for the specified phase.  <br /></td></tr>
<tr class="separator:ga7449a97209a4b56151de6fc5197a9daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab63947d9b9f7f49dbb62a8ceada3d30"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gaab63947d9b9f7f49dbb62a8ceada3d30">processPlusHalfCycle</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:gaab63947d9b9f7f49dbb62a8ceada3d30"><td class="mdescLeft">&#160;</td><td class="mdescRight">Process the start of a new positive half cycle for the specified phase.  <br /></td></tr>
<tr class="separator:gaab63947d9b9f7f49dbb62a8ceada3d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga81f4cbdafdfc13103fdfa34a136cd6fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga81f4cbdafdfc13103fdfa34a136cd6fd">processPolarity</a> (const uint8_t phase, const int16_t rawSample)</td></tr>
<tr class="memdesc:ga81f4cbdafdfc13103fdfa34a136cd6fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the polarity of the current voltage sample for a specific phase.  <br /></td></tr>
<tr class="separator:ga81f4cbdafdfc13103fdfa34a136cd6fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8cff922940989b7edaa8bd0347f9becc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc">processRawSamples</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:ga8cff922940989b7edaa8bd0347f9becc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes raw voltage and current samples for the specified phase.  <br /></td></tr>
<tr class="separator:ga8cff922940989b7edaa8bd0347f9becc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5a8b9dce34e44a69a46344e8ee1c0dd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6">processStartNewCycle</a> ()</td></tr>
<tr class="memdesc:ga5a8b9dce34e44a69a46344e8ee1c0dd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the start of a new mains cycle on phase 0.  <br /></td></tr>
<tr class="separator:ga5a8b9dce34e44a69a46344e8ee1c0dd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4bd9766ebd8acc09da5413f6d613f123"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga4bd9766ebd8acc09da5413f6d613f123">processStartUp</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:ga4bd9766ebd8acc09da5413f6d613f123"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the startup period for the router.  <br /></td></tr>
<tr class="separator:ga4bd9766ebd8acc09da5413f6d613f123"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaed3b88c01657f322f7b985574a3427fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#gaed3b88c01657f322f7b985574a3427fd">processVoltage</a> (const uint8_t phase)</td></tr>
<tr class="memdesc:gaed3b88c01657f322f7b985574a3427fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the current voltage sample for the specified phase.  <br /></td></tr>
<tr class="separator:gaed3b88c01657f322f7b985574a3427fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7b45c0ceb64e191cb1f053c28f02cee6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6">processVoltageRawSample</a> (const uint8_t phase, const int16_t rawSample)</td></tr>
<tr class="memdesc:ga7b45c0ceb64e191cb1f053c28f02cee6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Processes the current voltage raw sample for the specified phase.  <br /></td></tr>
<tr class="separator:ga7b45c0ceb64e191cb1f053c28f02cee6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1950a35c4c210dae480943adca0a3c88"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga1950a35c4c210dae480943adca0a3c88">updatePhysicalLoadStates</a> ()</td></tr>
<tr class="memdesc:ga1950a35c4c210dae480943adca0a3c88"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the physical load states based on logical load priorities and states.  <br /></td></tr>
<tr class="separator:ga1950a35c4c210dae480943adca0a3c88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga44ac46a7ff4e0717bd668d5907b38249"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__TimeCritical.html#ga44ac46a7ff4e0717bd668d5907b38249">updatePortsStates</a> ()</td></tr>
<tr class="memdesc:ga44ac46a7ff4e0717bd668d5907b38249"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the control ports for each of the physical loads.  <br /></td></tr>
<tr class="separator:ga44ac46a7ff4e0717bd668d5907b38249"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions used by the ISR. </p>
<p>This group contains functions that are executed within the Interrupt Service Routine (ISR) or are closely tied to time-sensitive operations. These functions are optimized for speed and efficiency to ensure the system operates without delays or interruptions.</p>
<dl class="section note"><dt>Note</dt><dd>These functions handle tasks such as ADC sampling, zero-crossing detection, and real-time data processing. </dd></dl>
<h2 class="groupheader">Function Documentation</h2>
<a id="gadc681bbd6c00b6c808ad999bc0e49542" name="gadc681bbd6c00b6c808ad999bc0e49542"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gadc681bbd6c00b6c808ad999bc0e49542">&#9670;&#160;</a></span>confirmPolarity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void confirmPolarity </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Confirms the polarity of the current voltage sample for a specific phase. </p>
<p>This routine prevents a zero-crossing point from being declared until a certain number of consecutive samples in the 'other' half of the waveform have been encountered.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>If the polarity of the most recent sample matches the last confirmed polarity, the persistence counter is reset.</li>
<li>If the polarity differs, the persistence counter is incremented.</li>
<li>Once the persistence counter exceeds a predefined threshold, the polarity is confirmed. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00463">463</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gadc681bbd6c00b6c808ad999bc0e49542_icgraph.png" border="0" usemap="#agroup__TimeCritical_gadc681bbd6c00b6c808ad999bc0e49542_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gadc681bbd6c00b6c808ad999bc0e49542_icgraph" id="agroup__TimeCritical_gadc681bbd6c00b6c808ad999bc0e49542_icgraph">
<area shape="rect" title="Confirms the polarity of the current voltage sample for a specific phase." alt="" coords="343,5,464,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga05c2e5b588ced1cd7312f5b0edc5b295" name="ga05c2e5b588ced1cd7312f5b0edc5b295"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga05c2e5b588ced1cd7312f5b0edc5b295">&#9670;&#160;</a></span>ISR()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">ADC_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Interrupt Service Routine - Interrupt-Driven Analog Conversion. </p>
<p>An Interrupt Service Routine is now defined which instructs the ADC to perform a conversion for each of the voltage and current sensors in turn.</p>
<p>This Interrupt Service Routine is for use when the ADC is in the free-running mode. It is executed whenever an ADC conversion has finished, approx every 104 Âµs. In free-running mode, the ADC has already started its next conversion by the time that the ISR is executed. The ISR therefore needs to "look ahead".</p>
<p>At the end of conversion Type N, conversion Type N+1 will start automatically. The ISR which runs at this point therefore needs to capture the results of conversion Type N, and set up the conditions for conversion Type N+2, and so on.</p>
<p>By means of various helper functions, all of the time-critical activities are processed within the ISR.</p>
<p>The main code is notified by means of a flag when fresh copies of loggable data are available.</p>
<p>Keep in mind, when writing an Interrupt Service Routine (ISR):</p><ul>
<li>Keep it short</li>
<li>Don't use delay()</li>
<li>Don't do serial prints</li>
<li>Make variables shared with the main code volatile</li>
<li>Variables shared with main code may need to be protected by "critical sections"</li>
<li>Don't try to turn interrupts off or on </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00077">77</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga05c2e5b588ced1cd7312f5b0edc5b295_cgraph.png" border="0" usemap="#agroup__TimeCritical_ga05c2e5b588ced1cd7312f5b0edc5b295_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga05c2e5b588ced1cd7312f5b0edc5b295_cgraph" id="agroup__TimeCritical_ga05c2e5b588ced1cd7312f5b0edc5b295_cgraph">
<area shape="rect" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,57,48,83"/>
<area shape="rect" href="group__TimeCritical.html#gafe8420bd47cd08c6d0327d4dbed06414" title="Processes the current raw sample for the specified phase." alt="" coords="97,32,294,57"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,81,295,107"/>
<area shape="rect" href="group__TimeCritical.html#gadc681bbd6c00b6c808ad999bc0e49542" title="Confirms the polarity of the current voltage sample for a specific phase." alt="" coords="360,7,481,32"/>
<area shape="rect" href="group__TimeCritical.html#ga81f4cbdafdfc13103fdfa34a136cd6fd" title="Processes the polarity of the current voltage sample for a specific phase." alt="" coords="359,56,482,81"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,105,499,131"/>
<area shape="rect" href="group__TimeCritical.html#gaed3b88c01657f322f7b985574a3427fd" title="Processes the current voltage sample for the specified phase." alt="" coords="360,155,481,180"/>
<area shape="rect" href="group__TimeCritical.html#ga7449a97209a4b56151de6fc5197a9daf" title="Processes the start of a new negative half cycle for the specified phase." alt="" coords="547,19,721,44"/>
<area shape="rect" href="group__TimeCritical.html#gaab63947d9b9f7f49dbb62a8ceada3d30" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="553,68,715,93"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="550,129,718,155"/>
<area shape="rect" href="group__TimeCritical.html#ga4bd9766ebd8acc09da5413f6d613f123" title="Processes the startup period for the router." alt="" coords="573,179,695,204"/>
<area shape="rect" href="group__TimeCritical.html#gaabf10592d01250ef862370d26c5a382b" title="Process data logging at the end of each logging period." alt="" coords="789,5,943,31"/>
<area shape="rect" href="group__TimeCritical.html#ga21380cdbe3f783dad431ff1a912cbaa1" title="Process the latest contribution after each phase&#45;specific new cycle." alt="" coords="770,55,962,80"/>
<area shape="rect" href="group__TimeCritical.html#gaef29df3a6c44ea8477b816cbdf3005f3" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="774,104,958,129"/>
<area shape="rect" href="group__TimeCritical.html#ga7ecb8f04a958d86156a6c95581f242d3" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="776,153,956,179"/>
<area shape="rect" href="group__TimeCritical.html#ga1950a35c4c210dae480943adca0a3c88" title="Updates the physical load states based on logical load priorities and states." alt="" coords="769,203,963,228"/>
<area shape="rect" href="group__TimeCritical.html#ga44ac46a7ff4e0717bd668d5907b38249" title="Updates the control ports for each of the physical loads." alt="" coords="795,252,937,277"/>
<area shape="rect" href="group__TimeCritical.html#ga8e7b88bb4b21554d23b57676a45e034e" title="Retrieve the next logical load that could be added." alt="" coords="1021,104,1221,129"/>
<area shape="rect" href="group__TimeCritical.html#gabfb25288a79335282af6922e833d3c35" title="Retrieve the next logical load that could be removed (in reverse order)." alt="" coords="1011,153,1232,179"/>
<area shape="rect" href="utils__pins_8h.html#a7195575c2ba8a186bd9758e4e2a141fd" title="Set the Pins state to OFF." alt="" coords="1074,227,1169,252"/>
<area shape="rect" href="utils__pins_8h.html#ae60db4342d45f22fa3bf5b297cf95bf3" title="Set the Pins state to ON." alt="" coords="1077,276,1166,301"/>
</map>
</div>

</div>
</div>
<a id="ga8e7b88bb4b21554d23b57676a45e034e" name="ga8e7b88bb4b21554d23b57676a45e034e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8e7b88bb4b21554d23b57676a45e034e">&#9670;&#160;</a></span>nextLogicalLoadToBeAdded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t nextLogicalLoadToBeAdded </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the next logical load that could be added. </p>
<p>This function identifies the next logical load that can be added based on the current load priorities and states. It iterates through the load priorities to find the first load that is currently OFF.</p>
<dl class="section return"><dt>Returns</dt><dd>The load number if a suitable load is found, or <code>NO_OF_DUMPLOADS</code> if no load can be added. </dd></dl>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00767">767</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga8e7b88bb4b21554d23b57676a45e034e_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga8e7b88bb4b21554d23b57676a45e034e_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga8e7b88bb4b21554d23b57676a45e034e_icgraph" id="agroup__TimeCritical_ga8e7b88bb4b21554d23b57676a45e034e_icgraph">
<area shape="rect" title="Retrieve the next logical load that could be added." alt="" coords="995,5,1195,31"/>
<area shape="rect" href="group__TimeCritical.html#gaef29df3a6c44ea8477b816cbdf3005f3" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="763,5,947,31"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="gabfb25288a79335282af6922e833d3c35" name="gabfb25288a79335282af6922e833d3c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabfb25288a79335282af6922e833d3c35">&#9670;&#160;</a></span>nextLogicalLoadToBeRemoved()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t nextLogicalLoadToBeRemoved </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Retrieve the next logical load that could be removed (in reverse order). </p>
<p>This function identifies the next logical load that can be removed based on the current load priorities and states. It iterates through the load priorities in reverse order to find the first load that is currently ON.</p>
<dl class="section return"><dt>Returns</dt><dd>The load number if a suitable load is found, or <code>NO_OF_DUMPLOADS</code> if no load can be removed. </dd></dl>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00792">792</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gabfb25288a79335282af6922e833d3c35_icgraph.png" border="0" usemap="#agroup__TimeCritical_gabfb25288a79335282af6922e833d3c35_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gabfb25288a79335282af6922e833d3c35_icgraph" id="agroup__TimeCritical_gabfb25288a79335282af6922e833d3c35_icgraph">
<area shape="rect" title="Retrieve the next logical load that could be removed (in reverse order)." alt="" coords="991,5,1212,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7ecb8f04a958d86156a6c95581f242d3" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="763,5,943,31"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="gaef29df3a6c44ea8477b816cbdf3005f3" name="gaef29df3a6c44ea8477b816cbdf3005f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef29df3a6c44ea8477b816cbdf3005f3">&#9670;&#160;</a></span>proceedHighEnergyLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void proceedHighEnergyLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles the case when the energy level is high, potentially adding a load. </p>
<p>This function determines if a new load can be added based on the current energy level and recent transitions. It updates the logical load states and thresholds accordingly.</p>
<ul>
<li>Identifies the next logical load to be added.</li>
<li>Ensures that only the active load can be switched during the post-transition period.</li>
<li>Updates the upper energy threshold and logical load states if a load is added. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00568">568</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_cgraph.png" border="0" usemap="#agroup__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_cgraph" id="agroup__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_cgraph">
<area shape="rect" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="5,5,189,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8e7b88bb4b21554d23b57676a45e034e" title="Retrieve the next logical load that could be added." alt="" coords="237,5,437,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_icgraph.png" border="0" usemap="#agroup__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_icgraph" id="agroup__TimeCritical_gaef29df3a6c44ea8477b816cbdf3005f3_icgraph">
<area shape="rect" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="763,5,947,31"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga7ecb8f04a958d86156a6c95581f242d3" name="ga7ecb8f04a958d86156a6c95581f242d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7ecb8f04a958d86156a6c95581f242d3">&#9670;&#160;</a></span>proceedLowEnergyLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void proceedLowEnergyLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handles the case when the energy level is low, potentially removing a load. </p>
<p>This function determines if a load can be removed based on the current energy level and recent transitions. It updates the logical load states and thresholds accordingly.</p>
<ul>
<li>Identifies the next logical load to be removed.</li>
<li>Ensures that only the active load can be switched during the post-transition period.</li>
<li>Updates the lower energy threshold and logical load states if a load is removed. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00617">617</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_cgraph.png" border="0" usemap="#agroup__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_cgraph" id="agroup__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_cgraph">
<area shape="rect" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="5,5,185,31"/>
<area shape="rect" href="group__TimeCritical.html#gabfb25288a79335282af6922e833d3c35" title="Retrieve the next logical load that could be removed (in reverse order)." alt="" coords="233,5,455,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_icgraph" id="agroup__TimeCritical_ga7ecb8f04a958d86156a6c95581f242d3_icgraph">
<area shape="rect" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="763,5,943,31"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="gafe8420bd47cd08c6d0327d4dbed06414" name="gafe8420bd47cd08c6d0327d4dbed06414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe8420bd47cd08c6d0327d4dbed06414">&#9670;&#160;</a></span>processCurrentRawSample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processCurrentRawSample </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t&#160;</td>
          <td class="paramname"><em>rawSample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the current raw sample for the specified phase. </p>
<p>This function processes the raw current sample for a specific phase by applying filtering to remove DC offset, compensating for the high-pass filter effect of current transformers (CTs), and calculating the instantaneous power.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[. </td></tr>
    <tr><td class="paramname">rawSample</td><td>The current raw sample for the specified phase.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The DC offset is removed from the raw sample.</li>
<li>Additional filtering is applied to offset the high-pass filter effect of CTs.</li>
<li>The instantaneous power is calculated and accumulated for the phase. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00424">424</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gafe8420bd47cd08c6d0327d4dbed06414_icgraph.png" border="0" usemap="#agroup__TimeCritical_gafe8420bd47cd08c6d0327d4dbed06414_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gafe8420bd47cd08c6d0327d4dbed06414_icgraph" id="agroup__TimeCritical_gafe8420bd47cd08c6d0327d4dbed06414_icgraph">
<area shape="rect" title="Processes the current raw sample for the specified phase." alt="" coords="96,5,293,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="gaabf10592d01250ef862370d26c5a382b" name="gaabf10592d01250ef862370d26c5a382b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaabf10592d01250ef862370d26c5a382b">&#9670;&#160;</a></span>processDataLogging()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processDataLogging </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process data logging at the end of each logging period. </p>
<p>This function handles the data logging process by copying relevant variables for use by the main code and resetting them for the next logging period.</p>
<ul>
<li>Copies cumulative power and voltage squared values for each phase.</li>
<li>Copies load ON counts and other diagnostic variables.</li>
<li>Resets variables for the next data logging period.</li>
<li>Signals the main processor that logging data is available after the startup period. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00853">853</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gaabf10592d01250ef862370d26c5a382b_icgraph.png" border="0" usemap="#agroup__TimeCritical_gaabf10592d01250ef862370d26c5a382b_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gaabf10592d01250ef862370d26c5a382b_icgraph" id="agroup__TimeCritical_gaabf10592d01250ef862370d26c5a382b_icgraph">
<area shape="rect" title="Process data logging at the end of each logging period." alt="" coords="757,5,912,31"/>
<area shape="rect" href="group__TimeCritical.html#gaab63947d9b9f7f49dbb62a8ceada3d30" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="547,5,709,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga21380cdbe3f783dad431ff1a912cbaa1" name="ga21380cdbe3f783dad431ff1a912cbaa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga21380cdbe3f783dad431ff1a912cbaa1">&#9670;&#160;</a></span>processLatestContribution()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processLatestContribution </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the latest contribution after each phase-specific new cycle. </p>
<p>This function calculates and updates the energy contribution for the specified phase after each new cycle. It ensures that the energy bucket is updated with the latest power measurements and applies necessary adjustments.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Adds the latest energy contribution to the main energy bucket.</li>
<li>Applies adjustments for required export energy on phase 0.</li>
<li>Signals a new mains cycle for phase 0. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00822">822</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga21380cdbe3f783dad431ff1a912cbaa1_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga21380cdbe3f783dad431ff1a912cbaa1_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga21380cdbe3f783dad431ff1a912cbaa1_icgraph" id="agroup__TimeCritical_ga21380cdbe3f783dad431ff1a912cbaa1_icgraph">
<area shape="rect" title="Process the latest contribution after each phase&#45;specific new cycle." alt="" coords="757,5,949,31"/>
<area shape="rect" href="group__TimeCritical.html#gaab63947d9b9f7f49dbb62a8ceada3d30" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="547,5,709,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga7449a97209a4b56151de6fc5197a9daf" name="ga7449a97209a4b56151de6fc5197a9daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7449a97209a4b56151de6fc5197a9daf">&#9670;&#160;</a></span>processMinusHalfCycle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processMinusHalfCycle </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the start of a new negative half cycle for the specified phase. </p>
<p>This function is called just after the zero-crossing point of a negative half cycle. It updates the low-pass filter (LPF) for removing the DC component from the voltage signal and ensures the LPF output remains within defined limits.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Updates the low-pass filter for DC offset removal using the cumulative voltage deltas.</li>
<li>Ensures the LPF output remains within the defined minimum and maximum range. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00731">731</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga7449a97209a4b56151de6fc5197a9daf_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga7449a97209a4b56151de6fc5197a9daf_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga7449a97209a4b56151de6fc5197a9daf_icgraph" id="agroup__TimeCritical_ga7449a97209a4b56151de6fc5197a9daf_icgraph">
<area shape="rect" title="Processes the start of a new negative half cycle for the specified phase." alt="" coords="547,5,721,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="gaab63947d9b9f7f49dbb62a8ceada3d30" name="gaab63947d9b9f7f49dbb62a8ceada3d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaab63947d9b9f7f49dbb62a8ceada3d30">&#9670;&#160;</a></span>processPlusHalfCycle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processPlusHalfCycle </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Process the start of a new positive half cycle for the specified phase. </p>
<p>This function is called just after the zero-crossing point of a positive half cycle. It processes the latest energy contribution, updates performance metrics, and handles data logging for phase 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Processes the latest energy contribution for the specified phase.</li>
<li>Updates the minimum number of ADC sample sets per mains cycle for phase 0.</li>
<li>Handles data logging at the end of the logging period for phase 0.</li>
<li>Resets cumulative power and sample count for the phase. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00910">910</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_cgraph.png" border="0" usemap="#agroup__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_cgraph" id="agroup__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_cgraph">
<area shape="rect" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="5,31,168,56"/>
<area shape="rect" href="group__TimeCritical.html#gaabf10592d01250ef862370d26c5a382b" title="Process data logging at the end of each logging period." alt="" coords="235,5,389,31"/>
<area shape="rect" href="group__TimeCritical.html#ga21380cdbe3f783dad431ff1a912cbaa1" title="Process the latest contribution after each phase&#45;specific new cycle." alt="" coords="216,55,408,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_icgraph.png" border="0" usemap="#agroup__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_icgraph" id="agroup__TimeCritical_gaab63947d9b9f7f49dbb62a8ceada3d30_icgraph">
<area shape="rect" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="547,5,709,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga81f4cbdafdfc13103fdfa34a136cd6fd" name="ga81f4cbdafdfc13103fdfa34a136cd6fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga81f4cbdafdfc13103fdfa34a136cd6fd">&#9670;&#160;</a></span>processPolarity()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processPolarity </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t&#160;</td>
          <td class="paramname"><em>rawSample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the polarity of the current voltage sample for a specific phase. </p>
<p>This function removes the DC offset from the raw voltage sample and determines the polarity (positive or negative) of the sample. The polarity is stored for use in zero-crossing detection and other processing tasks.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[. </td></tr>
    <tr><td class="paramname">rawSample</td><td>The current raw voltage sample for the specified phase.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The DC offset is subtracted from the raw sample using a low-pass filter (LPF).</li>
<li>The polarity is determined based on whether the filtered sample is greater than or less than zero. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00399">399</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga81f4cbdafdfc13103fdfa34a136cd6fd_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga81f4cbdafdfc13103fdfa34a136cd6fd_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga81f4cbdafdfc13103fdfa34a136cd6fd_icgraph" id="agroup__TimeCritical_ga81f4cbdafdfc13103fdfa34a136cd6fd_icgraph">
<area shape="rect" title="Processes the polarity of the current voltage sample for a specific phase." alt="" coords="343,5,465,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga8cff922940989b7edaa8bd0347f9becc" name="ga8cff922940989b7edaa8bd0347f9becc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8cff922940989b7edaa8bd0347f9becc">&#9670;&#160;</a></span>processRawSamples()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processRawSamples </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes raw voltage and current samples for the specified phase. </p>
<p>This routine is called by the ISR when a pair of voltage and current samples becomes available. It handles the processing of raw samples, including polarity detection, zero-crossing handling, and half-cycle processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Determines the polarity of the current sample and handles transitions between positive and negative half cycles.</li>
<li>Processes the start of new positive and negative half cycles.</li>
<li>For phase 0, it triggers the start of a new mains cycle and handles startup logic. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00948">948</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_cgraph.png" border="0" usemap="#agroup__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_cgraph" id="agroup__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_cgraph">
<area shape="rect" title="Processes raw voltage and current samples for the specified phase." alt="" coords="5,105,161,131"/>
<area shape="rect" href="group__TimeCritical.html#ga7449a97209a4b56151de6fc5197a9daf" title="Processes the start of a new negative half cycle for the specified phase." alt="" coords="209,19,384,44"/>
<area shape="rect" href="group__TimeCritical.html#gaab63947d9b9f7f49dbb62a8ceada3d30" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="215,68,378,93"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="213,129,381,155"/>
<area shape="rect" href="group__TimeCritical.html#ga4bd9766ebd8acc09da5413f6d613f123" title="Processes the startup period for the router." alt="" coords="236,179,357,204"/>
<area shape="rect" href="group__TimeCritical.html#gaabf10592d01250ef862370d26c5a382b" title="Process data logging at the end of each logging period." alt="" coords="451,5,606,31"/>
<area shape="rect" href="group__TimeCritical.html#ga21380cdbe3f783dad431ff1a912cbaa1" title="Process the latest contribution after each phase&#45;specific new cycle." alt="" coords="433,55,625,80"/>
<area shape="rect" href="group__TimeCritical.html#gaef29df3a6c44ea8477b816cbdf3005f3" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="437,104,621,129"/>
<area shape="rect" href="group__TimeCritical.html#ga7ecb8f04a958d86156a6c95581f242d3" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="439,153,619,179"/>
<area shape="rect" href="group__TimeCritical.html#ga1950a35c4c210dae480943adca0a3c88" title="Updates the physical load states based on logical load priorities and states." alt="" coords="432,203,625,228"/>
<area shape="rect" href="group__TimeCritical.html#ga44ac46a7ff4e0717bd668d5907b38249" title="Updates the control ports for each of the physical loads." alt="" coords="458,252,599,277"/>
<area shape="rect" href="group__TimeCritical.html#ga8e7b88bb4b21554d23b57676a45e034e" title="Retrieve the next logical load that could be added." alt="" coords="684,104,884,129"/>
<area shape="rect" href="group__TimeCritical.html#gabfb25288a79335282af6922e833d3c35" title="Retrieve the next logical load that could be removed (in reverse order)." alt="" coords="673,153,895,179"/>
<area shape="rect" href="utils__pins_8h.html#a7195575c2ba8a186bd9758e4e2a141fd" title="Set the Pins state to OFF." alt="" coords="737,227,831,252"/>
<area shape="rect" href="utils__pins_8h.html#ae60db4342d45f22fa3bf5b297cf95bf3" title="Set the Pins state to ON." alt="" coords="739,276,829,301"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_icgraph" id="agroup__TimeCritical_ga8cff922940989b7edaa8bd0347f9becc_icgraph">
<area shape="rect" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga5a8b9dce34e44a69a46344e8ee1c0dd6" name="ga5a8b9dce34e44a69a46344e8ee1c0dd6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5a8b9dce34e44a69a46344e8ee1c0dd6">&#9670;&#160;</a></span>processStartNewCycle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processStartNewCycle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the start of a new mains cycle on phase 0. </p>
<p>This function is executed once per 20ms (for 50Hz), shortly after the start of each new mains cycle on phase 0. It manages the energy level and load states, ensuring proper operation of the system.</p>
<ul>
<li>Handles recent transitions and updates the post-transition counter.</li>
<li>Adjusts energy thresholds and determines whether to add or remove loads.</li>
<li>Updates the physical load states and control ports.</li>
<li>Ensures the energy bucket level remains within defined limits. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00668">668</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_cgraph.png" border="0" usemap="#agroup__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_cgraph" id="agroup__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_cgraph">
<area shape="rect" title="Processes the start of a new mains cycle on phase 0." alt="" coords="5,80,173,105"/>
<area shape="rect" href="group__TimeCritical.html#gaef29df3a6c44ea8477b816cbdf3005f3" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="226,5,410,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7ecb8f04a958d86156a6c95581f242d3" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="228,55,408,80"/>
<area shape="rect" href="group__TimeCritical.html#ga1950a35c4c210dae480943adca0a3c88" title="Updates the physical load states based on logical load priorities and states." alt="" coords="221,104,415,129"/>
<area shape="rect" href="group__TimeCritical.html#ga44ac46a7ff4e0717bd668d5907b38249" title="Updates the control ports for each of the physical loads." alt="" coords="247,153,389,179"/>
<area shape="rect" href="group__TimeCritical.html#ga8e7b88bb4b21554d23b57676a45e034e" title="Retrieve the next logical load that could be added." alt="" coords="473,5,673,31"/>
<area shape="rect" href="group__TimeCritical.html#gabfb25288a79335282af6922e833d3c35" title="Retrieve the next logical load that could be removed (in reverse order)." alt="" coords="463,55,684,80"/>
<area shape="rect" href="utils__pins_8h.html#a7195575c2ba8a186bd9758e4e2a141fd" title="Set the Pins state to OFF." alt="" coords="526,104,621,129"/>
<area shape="rect" href="utils__pins_8h.html#ae60db4342d45f22fa3bf5b297cf95bf3" title="Set the Pins state to ON." alt="" coords="529,153,618,179"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_icgraph" id="agroup__TimeCritical_ga5a8b9dce34e44a69a46344e8ee1c0dd6_icgraph">
<area shape="rect" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga4bd9766ebd8acc09da5413f6d613f123" name="ga4bd9766ebd8acc09da5413f6d613f123"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4bd9766ebd8acc09da5413f6d613f123">&#9670;&#160;</a></span>processStartUp()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processStartUp </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the startup period for the router. </p>
<p>This function handles the initial startup period, allowing the DC-blocking filters to settle before normal operation begins. It ensures that the system is stable before processing energy and load states.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>During the startup period, the function waits until the filters have settled.</li>
<li>Once the startup period is over, it resets key variables and flags to prepare for normal operation. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00536">536</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga4bd9766ebd8acc09da5413f6d613f123_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga4bd9766ebd8acc09da5413f6d613f123_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga4bd9766ebd8acc09da5413f6d613f123_icgraph" id="agroup__TimeCritical_ga4bd9766ebd8acc09da5413f6d613f123_icgraph">
<area shape="rect" title="Processes the startup period for the router." alt="" coords="547,5,668,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="gaed3b88c01657f322f7b985574a3427fd" name="gaed3b88c01657f322f7b985574a3427fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaed3b88c01657f322f7b985574a3427fd">&#9670;&#160;</a></span>processVoltage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void processVoltage </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Processes the current voltage sample for the specified phase. </p>
<p>This function processes the voltage sample for a specific phase by calculating the cumulative voltage squared (VÂ²) for RMS calculations, updating the low-pass filter for DC offset removal, and preparing for zero-crossing detection.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The voltage squared (VÂ²) is calculated and accumulated for RMS calculations.</li>
<li>The low-pass filter is updated to remove the DC offset from the voltage signal.</li>
<li>The polarity of the last confirmed sample is stored for zero-crossing detection.</li>
<li>The number of samples during the current mains cycle is incremented. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00497">497</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_gaed3b88c01657f322f7b985574a3427fd_icgraph.png" border="0" usemap="#agroup__TimeCritical_gaed3b88c01657f322f7b985574a3427fd_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_gaed3b88c01657f322f7b985574a3427fd_icgraph" id="agroup__TimeCritical_gaed3b88c01657f322f7b985574a3427fd_icgraph">
<area shape="rect" title="Processes the current voltage sample for the specified phase." alt="" coords="343,5,464,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga7b45c0ceb64e191cb1f053c28f02cee6" name="ga7b45c0ceb64e191cb1f053c28f02cee6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7b45c0ceb64e191cb1f053c28f02cee6">&#9670;&#160;</a></span>processVoltageRawSample()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processVoltageRawSample </td>
          <td>(</td>
          <td class="paramtype">const uint8_t&#160;</td>
          <td class="paramname"><em>phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int16_t&#160;</td>
          <td class="paramname"><em>rawSample</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Processes the current voltage raw sample for the specified phase. </p>
<p>This function processes the raw voltage sample for a specific phase by handling polarity detection, zero-crossing confirmation, and voltage processing. It ensures that the voltage sample is properly filtered and analyzed for further processing.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">phase</td><td>The phase number [0..NO_OF_PHASES[. </td></tr>
    <tr><td class="paramname">rawSample</td><td>The current raw voltage sample for the specified phase.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>Determines and confirms the polarity of the raw voltage sample.</li>
<li>Handles zero-crossing detection and processes raw samples for the phase.</li>
<li>Updates voltage-related metrics and increments the sample set count for phase 0. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l01005">1005</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_cgraph.png" border="0" usemap="#agroup__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_cgraph" id="agroup__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_cgraph">
<area shape="rect" title="Processes the current voltage raw sample for the specified phase." alt="" coords="5,81,204,107"/>
<area shape="rect" href="group__TimeCritical.html#gadc681bbd6c00b6c808ad999bc0e49542" title="Confirms the polarity of the current voltage sample for a specific phase." alt="" coords="269,7,391,32"/>
<area shape="rect" href="group__TimeCritical.html#ga81f4cbdafdfc13103fdfa34a136cd6fd" title="Processes the polarity of the current voltage sample for a specific phase." alt="" coords="269,56,391,81"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="252,105,408,131"/>
<area shape="rect" href="group__TimeCritical.html#gaed3b88c01657f322f7b985574a3427fd" title="Processes the current voltage sample for the specified phase." alt="" coords="269,155,391,180"/>
<area shape="rect" href="group__TimeCritical.html#ga7449a97209a4b56151de6fc5197a9daf" title="Processes the start of a new negative half cycle for the specified phase." alt="" coords="456,19,631,44"/>
<area shape="rect" href="group__TimeCritical.html#gaab63947d9b9f7f49dbb62a8ceada3d30" title="Process the start of a new positive half cycle for the specified phase." alt="" coords="462,68,625,93"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="459,129,627,155"/>
<area shape="rect" href="group__TimeCritical.html#ga4bd9766ebd8acc09da5413f6d613f123" title="Processes the startup period for the router." alt="" coords="483,179,604,204"/>
<area shape="rect" href="group__TimeCritical.html#gaabf10592d01250ef862370d26c5a382b" title="Process data logging at the end of each logging period." alt="" coords="698,5,853,31"/>
<area shape="rect" href="group__TimeCritical.html#ga21380cdbe3f783dad431ff1a912cbaa1" title="Process the latest contribution after each phase&#45;specific new cycle." alt="" coords="679,55,871,80"/>
<area shape="rect" href="group__TimeCritical.html#gaef29df3a6c44ea8477b816cbdf3005f3" title="Handles the case when the energy level is high, potentially adding a load." alt="" coords="683,104,867,129"/>
<area shape="rect" href="group__TimeCritical.html#ga7ecb8f04a958d86156a6c95581f242d3" title="Handles the case when the energy level is low, potentially removing a load." alt="" coords="685,153,865,179"/>
<area shape="rect" href="group__TimeCritical.html#ga1950a35c4c210dae480943adca0a3c88" title="Updates the physical load states based on logical load priorities and states." alt="" coords="679,203,872,228"/>
<area shape="rect" href="group__TimeCritical.html#ga44ac46a7ff4e0717bd668d5907b38249" title="Updates the control ports for each of the physical loads." alt="" coords="705,252,846,277"/>
<area shape="rect" href="group__TimeCritical.html#ga8e7b88bb4b21554d23b57676a45e034e" title="Retrieve the next logical load that could be added." alt="" coords="931,104,1131,129"/>
<area shape="rect" href="group__TimeCritical.html#gabfb25288a79335282af6922e833d3c35" title="Retrieve the next logical load that could be removed (in reverse order)." alt="" coords="920,153,1141,179"/>
<area shape="rect" href="utils__pins_8h.html#a7195575c2ba8a186bd9758e4e2a141fd" title="Set the Pins state to OFF." alt="" coords="983,227,1078,252"/>
<area shape="rect" href="utils__pins_8h.html#ae60db4342d45f22fa3bf5b297cf95bf3" title="Set the Pins state to ON." alt="" coords="986,276,1075,301"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_icgraph" id="agroup__TimeCritical_ga7b45c0ceb64e191cb1f053c28f02cee6_icgraph">
<area shape="rect" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga1950a35c4c210dae480943adca0a3c88" name="ga1950a35c4c210dae480943adca0a3c88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1950a35c4c210dae480943adca0a3c88">&#9670;&#160;</a></span>updatePhysicalLoadStates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updatePhysicalLoadStates </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the physical load states based on logical load priorities and states. </p>
<p>This function maps the logical load states to the physical load states. It ensures that the physical loads are updated according to the logical priorities and states. The function also handles priority rotation if enabled.</p>
<p>The array, logicalLoadState[], contains the on/off state of all logical loads, with element 0 being for the one with the highest priority. The array, physicalLoadState[], contains the on/off state of all physical loads.</p>
<p>The lowest 7 bits of element is the load number as defined in 'physicalLoadState'. The highest bit of each 'loadPrioritiesAndState' determines if the load is ON or OFF. The order of each element in 'loadPrioritiesAndState' determines the load priority. 'loadPrioritiesAndState[i] &amp; loadStateMask' will extract the load number at position 'i' 'loadPrioritiesAndState[i] &amp; loadStateOnBit' will extract the load state at position 'i'</p>
<p>Any other mapping relationships could be configured here.</p>
<dl class="section note"><dt>Note</dt><dd>This function is called during each cycle to ensure the physical load states are synchronized with the logical load states. </dd></dl>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00340">340</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga1950a35c4c210dae480943adca0a3c88_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga1950a35c4c210dae480943adca0a3c88_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga1950a35c4c210dae480943adca0a3c88_icgraph" id="agroup__TimeCritical_ga1950a35c4c210dae480943adca0a3c88_icgraph">
<area shape="rect" title="Updates the physical load states based on logical load priorities and states." alt="" coords="763,5,956,31"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
<a id="ga44ac46a7ff4e0717bd668d5907b38249" name="ga44ac46a7ff4e0717bd668d5907b38249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga44ac46a7ff4e0717bd668d5907b38249">&#9670;&#160;</a></span>updatePortsStates()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void updatePortsStates </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates the control ports for each of the physical loads. </p>
<p>This function determines the ON/OFF state of each physical load and updates the corresponding control ports. It ensures that the correct pins are set to their respective states based on the load's current status.</p>
<ul>
<li>If a load is OFF, its corresponding pin is added to the <code>pinsOFF</code> mask.</li>
<li>If a load is ON, its corresponding pin is added to the <code>pinsON</code> mask.</li>
<li>Finally, the pins are updated using <code>setPinsOFF</code> and <code>setPinsON</code> functions. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="processing_8cpp_source.html#l00288">288</a> of file <a class="el" href="processing_8cpp_source.html">processing.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_cgraph.png" border="0" usemap="#agroup__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_cgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_cgraph" id="agroup__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_cgraph">
<area shape="rect" title="Updates the control ports for each of the physical loads." alt="" coords="5,31,147,56"/>
<area shape="rect" href="utils__pins_8h.html#a7195575c2ba8a186bd9758e4e2a141fd" title="Set the Pins state to OFF." alt="" coords="195,5,289,31"/>
<area shape="rect" href="utils__pins_8h.html#ae60db4342d45f22fa3bf5b297cf95bf3" title="Set the Pins state to ON." alt="" coords="197,55,287,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_icgraph.png" border="0" usemap="#agroup__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_icgraph" alt=""/></div>
<map name="agroup__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_icgraph" id="agroup__TimeCritical_ga44ac46a7ff4e0717bd668d5907b38249_icgraph">
<area shape="rect" title="Updates the control ports for each of the physical loads." alt="" coords="763,5,904,31"/>
<area shape="rect" href="group__TimeCritical.html#ga5a8b9dce34e44a69a46344e8ee1c0dd6" title="Processes the start of a new mains cycle on phase 0." alt="" coords="547,5,715,31"/>
<area shape="rect" href="group__TimeCritical.html#ga8cff922940989b7edaa8bd0347f9becc" title="Processes raw voltage and current samples for the specified phase." alt="" coords="343,5,499,31"/>
<area shape="rect" href="group__TimeCritical.html#ga7b45c0ceb64e191cb1f053c28f02cee6" title="Processes the current voltage raw sample for the specified phase." alt="" coords="96,5,295,31"/>
<area shape="rect" href="group__TimeCritical.html#ga05c2e5b588ced1cd7312f5b0edc5b295" title="Interrupt Service Routine &#45; Interrupt&#45;Driven Analog Conversion." alt="" coords="5,5,48,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
