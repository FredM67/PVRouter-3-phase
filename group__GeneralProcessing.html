<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>3-phase PV router: General Processing</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">3-phase PV router
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">General Processing</div></div>
</div><!--header-->
<div class="contents">

<p>Functions and routines that handle general system processing tasks.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga31f3d562faae6b598324b56299d74f7d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#ga31f3d562faae6b598324b56299d74f7d">checkDiversionOnOff</a> ()</td></tr>
<tr class="memdesc:ga31f3d562faae6b598324b56299d74f7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks and updates the diversion state based on the diversion pin.  <br /></td></tr>
<tr class="separator:ga31f3d562faae6b598324b56299d74f7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5157f7f79cf8c75c2d7b41d8ed47a7ef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#ga5157f7f79cf8c75c2d7b41d8ed47a7ef">forceFullPower</a> ()</td></tr>
<tr class="memdesc:ga5157f7f79cf8c75c2d7b41d8ed47a7ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forces all loads to full power if the override pin is active.  <br /></td></tr>
<tr class="separator:ga5157f7f79cf8c75c2d7b41d8ed47a7ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga143b5ab1cc611c04c761240ce5687fdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd">handlePerSecondTasks</a> (bool &amp;bOffPeak, int16_t &amp;iTemperature_x100)</td></tr>
<tr class="memdesc:ga143b5ab1cc611c04c761240ce5687fdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles tasks that need to be executed every second.  <br /></td></tr>
<tr class="separator:ga143b5ab1cc611c04c761240ce5687fdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafe461d27b9c48d5921c00d521181f12f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f">loop</a> ()</td></tr>
<tr class="memdesc:gafe461d27b9c48d5921c00d521181f12f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main processor loop.  <br /></td></tr>
<tr class="separator:gafe461d27b9c48d5921c00d521181f12f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab4774b22349c58cef345ad396aecc868"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#gab4774b22349c58cef345ad396aecc868">proceedLoadPrioritiesAndOverriding</a> (const int16_t &amp;currentTemperature_x100)</td></tr>
<tr class="memdesc:gab4774b22349c58cef345ad396aecc868"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles load priorities and overriding logic.  <br /></td></tr>
<tr class="separator:gab4774b22349c58cef345ad396aecc868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2b2ee7cd0a5810e272e1ffb0b5daf0ae"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#ga2b2ee7cd0a5810e272e1ffb0b5daf0ae">proceedLoadPrioritiesAndOverridingDualTariff</a> (const int16_t &amp;currentTemperature_x100)</td></tr>
<tr class="memdesc:ga2b2ee7cd0a5810e272e1ffb0b5daf0ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handles load priorities and overriding during dual tariff periods.  <br /></td></tr>
<tr class="separator:ga2b2ee7cd0a5810e272e1ffb0b5daf0ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9b9428fd01019319970f27b88bb1cf33"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#ga9b9428fd01019319970f27b88bb1cf33">proceedRotation</a> ()</td></tr>
<tr class="memdesc:ga9b9428fd01019319970f27b88bb1cf33"><td class="mdescLeft">&#160;</td><td class="mdescRight">Proceeds with load priority rotation.  <br /></td></tr>
<tr class="separator:ga9b9428fd01019319970f27b88bb1cf33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga09f681954987d95f85831ca82365f987"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__GeneralProcessing.html#ga09f681954987d95f85831ca82365f987">updatePowerAndVoltageData</a> ()</td></tr>
<tr class="memdesc:ga09f681954987d95f85831ca82365f987"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates power and voltage data for all phases.  <br /></td></tr>
<tr class="separator:ga09f681954987d95f85831ca82365f987"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions and routines that handle general system processing tasks. </p>
<p>This group includes functions that are not time-critical but are essential for the overall operation of the system. These tasks include monitoring system states, managing load priorities, and handling diversion logic.</p>
<ul>
<li>Functions in this group are typically called from the main loop or other non-interrupt contexts.</li>
<li>They ensure the system operates correctly and adapts to changing conditions. </li>
</ul>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga31f3d562faae6b598324b56299d74f7d" name="ga31f3d562faae6b598324b56299d74f7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga31f3d562faae6b598324b56299d74f7d">&#9670;&#160;</a></span>checkDiversionOnOff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void checkDiversionOnOff </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks and updates the diversion state based on the diversion pin. </p>
<p>This function monitors the state of the diversion pin and updates the global <code>b_diversionOff</code> flag accordingly. It also logs changes in the diversion state for debugging purposes if enabled.</p>
<ul>
<li>If the diversion pin is LOW, the diversion is considered OFF.</li>
<li>If the diversion pin is HIGH, the diversion is considered ON.</li>
<li>Debug messages are printed when the diversion state changes (if debugging is enabled). </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00190">190</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_cgraph" id="agroup__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_cgraph">
<area shape="rect" title="Checks and updates the diversion state based on the diversion pin." alt="" coords="5,5,164,31"/>
<area shape="rect" href="utils__pins_8h.html#a410a7bdd300104398ce91797bd936cdb" title="Get the Pin State." alt="" coords="212,5,309,31"/>
<area shape="rect" href="utils__pins_8h.html#abaa54130a12679d0dcc0e7578e0e4d37" title="Read the specified bit." alt="" coords="357,5,432,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_icgraph" id="agroup__GeneralProcessing_ga31f3d562faae6b598324b56299d74f7d_icgraph">
<area shape="rect" title="Checks and updates the diversion state based on the diversion pin." alt="" coords="323,5,481,31"/>
<area shape="rect" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd" title="Handles tasks that need to be executed every second." alt="" coords="104,5,275,31"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="ga5157f7f79cf8c75c2d7b41d8ed47a7ef" name="ga5157f7f79cf8c75c2d7b41d8ed47a7ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5157f7f79cf8c75c2d7b41d8ed47a7ef">&#9670;&#160;</a></span>forceFullPower()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool forceFullPower </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forces all loads to full power if the override pin is active. </p>
<p>This function checks the state of the override pin and forces all loads to full power if the pin is active. It also logs changes in the override state for debugging purposes if enabled.</p>
<ul>
<li>If the override pin is LOW, all loads are forced to full power.</li>
<li>If the override pin is HIGH, normal load behavior is restored.</li>
<li>Debug messages are printed when the override state changes (if debugging is enabled).</li>
</ul>
<dl class="section return"><dt>Returns</dt><dd>true if loads are forced to full power, false otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00147">147</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_cgraph" id="agroup__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_cgraph">
<area shape="rect" title="Forces all loads to full power if the override pin is active." alt="" coords="5,5,124,31"/>
<area shape="rect" href="utils__pins_8h.html#a410a7bdd300104398ce91797bd936cdb" title="Get the Pin State." alt="" coords="172,5,269,31"/>
<area shape="rect" href="utils__pins_8h.html#abaa54130a12679d0dcc0e7578e0e4d37" title="Read the specified bit." alt="" coords="317,5,392,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_icgraph" id="agroup__GeneralProcessing_ga5157f7f79cf8c75c2d7b41d8ed47a7ef_icgraph">
<area shape="rect" title="Forces all loads to full power if the override pin is active." alt="" coords="323,5,441,31"/>
<area shape="rect" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd" title="Handles tasks that need to be executed every second." alt="" coords="104,5,275,31"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="ga143b5ab1cc611c04c761240ce5687fdd" name="ga143b5ab1cc611c04c761240ce5687fdd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga143b5ab1cc611c04c761240ce5687fdd">&#9670;&#160;</a></span>handlePerSecondTasks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void handlePerSecondTasks </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&#160;</td>
          <td class="paramname"><em>bOffPeak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t &amp;&#160;</td>
          <td class="paramname"><em>iTemperature_x100</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles tasks that need to be executed every second. </p>
<p>This function performs various tasks that are triggered once per second, ensuring proper system operation and load management.</p>
<ul>
<li>Increments the absence of diverted energy count if no energy is being diverted.</li>
<li>Toggles the watchdog pin if the feature is enabled.</li>
<li>Checks and updates the diversion state.</li>
<li>Manages load priorities and overriding based on the current temperature.</li>
<li>Updates relay durations and proceeds with relay state transitions if relay diversion is enabled.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bOffPeak</td><td>Reference to the off-peak state flag. </td></tr>
    <tr><td class="paramname">iTemperature_x100</td><td>Current temperature multiplied by 100 (default to 0 if temperature sensing is disabled). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00491">491</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_cgraph" id="agroup__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_cgraph">
<area shape="rect" title="Handles tasks that need to be executed every second." alt="" coords="5,133,176,159"/>
<area shape="rect" href="group__GeneralProcessing.html#ga31f3d562faae6b598324b56299d74f7d" title="Checks and updates the diversion state based on the diversion pin." alt="" coords="477,5,636,31"/>
<area shape="rect" href="group__GeneralProcessing.html#ga5157f7f79cf8c75c2d7b41d8ed47a7ef" title="Forces all loads to full power if the override pin is active." alt="" coords="497,56,616,81"/>
<area shape="rect" href="classRelayEngine.html#a4f831b566b2da140a17333ab6a39e5dc" title="Increment the duration&#39;s state of each relay." alt="" coords="224,104,415,129"/>
<area shape="rect" href="classRelayEngine.html#a2891986bc989d9c35301711f674bc523" title="Proceed all relays in increasing order (surplus) or decreasing order (import)." alt="" coords="238,154,401,194"/>
<area shape="rect" href="group__GeneralProcessing.html#gab4774b22349c58cef345ad396aecc868" title="Handles load priorities and overriding logic." alt="" coords="225,218,413,258"/>
<area shape="rect" href="utils__pins_8h.html#aaec5db9d46ba784c4f16046e6deb6977" title="Toggle the specified pin." alt="" coords="278,283,361,308"/>
<area shape="rect" href="utils__pins_8h.html#a410a7bdd300104398ce91797bd936cdb" title="Get the Pin State." alt="" coords="715,83,812,108"/>
<area shape="rect" href="utils__pins_8h.html#abaa54130a12679d0dcc0e7578e0e4d37" title="Read the specified bit." alt="" coords="904,83,979,108"/>
<area shape="rect" href="group__GeneralProcessing.html#ga2b2ee7cd0a5810e272e1ffb0b5daf0ae" title="Handles load priorities and overriding during dual tariff periods." alt="" coords="463,161,651,201"/>
<area shape="rect" href="group__GeneralProcessing.html#ga9b9428fd01019319970f27b88bb1cf33" title="Proceeds with load priority rotation." alt="" coords="699,196,828,221"/>
<area shape="rect" href="utils_8h.html#ae473b1c0d80fe056d1fab9bdee38aca1" title="Prints the load priorities to the Serial output." alt="" coords="876,196,1007,221"/>
<area shape="rect" href="utils__pins_8h.html#a23ed26b879b65f5ddf07facc1e4b18bc" title="Set the specified bit to 1." alt="" coords="523,283,590,308"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_icgraph" id="agroup__GeneralProcessing_ga143b5ab1cc611c04c761240ce5687fdd_icgraph">
<area shape="rect" title="Handles tasks that need to be executed every second." alt="" coords="104,5,275,31"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
<a id="gafe461d27b9c48d5921c00d521181f12f" name="gafe461d27b9c48d5921c00d521181f12f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gafe461d27b9c48d5921c00d521181f12f">&#9670;&#160;</a></span>loop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Main processor loop. </p>
<p>This function handles non-time-critical tasks such as load management, telemetry updates, and temperature sensing. It processes ADC data through flags set by the ISR and ensures proper system operation.</p>
<ul>
<li>Executes tasks triggered by the <code>b_newMainsCycle</code> flag, which is set after every pair of ADC conversions.</li>
<li>Handles per-second tasks such as load priority management and diversion state updates.</li>
<li>Processes data logging events and updates power, voltage, and temperature data.</li>
<li>Sends telemetry results and updates relay states if relay diversion is enabled. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00532">532</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_gafe461d27b9c48d5921c00d521181f12f_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_gafe461d27b9c48d5921c00d521181f12f_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_gafe461d27b9c48d5921c00d521181f12f_cgraph" id="agroup__GeneralProcessing_gafe461d27b9c48d5921c00d521181f12f_cgraph">
<area shape="rect" title="Main processor loop." alt="" coords="5,537,56,563"/>
<area shape="rect" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd" title="Handles tasks that need to be executed every second." alt="" coords="125,161,295,187"/>
<area shape="rect" href="main_8cpp.html#a90dc0c3192649d64ae885b62e6afa6e4" title="Processes temperature data from DS18B20 sensors." alt="" coords="117,423,303,448"/>
<area shape="rect" href="utils_8h.html#ade56d6fce22a518b8feff1a150461f94" title="Prints data logs to the Serial output in text or json format." alt="" coords="159,537,261,563"/>
<area shape="rect" href="classRelayEngine.html#a2c8796258ac6cd4006a55c236c383287" title="Update the sliding average." alt="" coords="132,587,288,627"/>
<area shape="rect" href="group__GeneralProcessing.html#ga09f681954987d95f85831ca82365f987" title="Updates power and voltage data for all phases." alt="" coords="104,652,316,677"/>
<area shape="rect" href="group__GeneralProcessing.html#ga31f3d562faae6b598324b56299d74f7d" title="Checks and updates the diversion state based on the diversion pin." alt="" coords="619,5,778,31"/>
<area shape="rect" href="group__GeneralProcessing.html#ga5157f7f79cf8c75c2d7b41d8ed47a7ef" title="Forces all loads to full power if the override pin is active." alt="" coords="639,56,758,81"/>
<area shape="rect" href="classRelayEngine.html#a4f831b566b2da140a17333ab6a39e5dc" title="Increment the duration&#39;s state of each relay." alt="" coords="364,104,555,129"/>
<area shape="rect" href="classRelayEngine.html#a2891986bc989d9c35301711f674bc523" title="Proceed all relays in increasing order (surplus) or decreasing order (import)." alt="" coords="378,154,541,194"/>
<area shape="rect" href="group__GeneralProcessing.html#gab4774b22349c58cef345ad396aecc868" title="Handles load priorities and overriding logic." alt="" coords="365,218,553,258"/>
<area shape="rect" href="utils__pins_8h.html#aaec5db9d46ba784c4f16046e6deb6977" title="Toggle the specified pin." alt="" coords="418,283,501,308"/>
<area shape="rect" href="utils__pins_8h.html#a410a7bdd300104398ce91797bd936cdb" title="Get the Pin State." alt="" coords="898,83,995,108"/>
<area shape="rect" href="utils__pins_8h.html#abaa54130a12679d0dcc0e7578e0e4d37" title="Read the specified bit." alt="" coords="1127,83,1201,108"/>
<area shape="rect" href="group__GeneralProcessing.html#ga2b2ee7cd0a5810e272e1ffb0b5daf0ae" title="Handles load priorities and overriding during dual tariff periods." alt="" coords="605,161,793,201"/>
<area shape="rect" href="group__GeneralProcessing.html#ga9b9428fd01019319970f27b88bb1cf33" title="Proceeds with load priority rotation." alt="" coords="882,196,1011,221"/>
<area shape="rect" href="utils_8h.html#ae473b1c0d80fe056d1fab9bdee38aca1" title="Prints the load priorities to the Serial output." alt="" coords="1099,196,1229,221"/>
<area shape="rect" href="utils__pins_8h.html#a23ed26b879b65f5ddf07facc1e4b18bc" title="Set the specified bit to 1." alt="" coords="665,283,732,308"/>
<area shape="rect" href="classTemperatureSensing.html#a2ee48e23ceaf2bbc08cc4be575bb7d90" title="Get the number of sensors." alt="" coords="621,497,776,537"/>
<area shape="rect" href="classTemperatureSensing.html#a818e69732219334348f6e6e44774d0fe" title="Reads the temperature of a specific sensor." alt="" coords="382,383,537,423"/>
<area shape="rect" href="classTemperatureSensing.html#a10629740380a6f688ac5c70346a94c80" title="Request temperature for all sensors." alt="" coords="375,447,543,487"/>
<area shape="rect" href="utils_8h.html#a988b25d4a6361b7cc751a212af170665" title="Write on Serial in EmonESP format." alt="" coords="390,512,529,537"/>
<area shape="rect" href="utils_8h.html#ae46d07fd4694c49e10360b5d79163443" title="Prints data logs to the Serial output in text format." alt="" coords="391,561,527,587"/>
<area shape="rect" href="utils__rf_8h.html#ab5bc929f5a874ed02b16ed1d620d71cf" title="Send the logging data through RF." alt="" coords="406,611,513,636"/>
<area shape="rect" href="utils_8h.html#a5072aae7cb8a3f575605b65c6be56329" title="Sends telemetry data using the TeleInfo class." alt="" coords="385,660,534,685"/>
<area shape="rect" href="classRelayEngine.html#a2c586921b020480449159786461195aa" title="Get the current average." alt="" coords="603,561,795,587"/>
<area shape="rect" href="classTeleInfo.html#a37b1447161869bf3ecc2faed134b7eee" title="Finalizes the frame by adding the end character and sending the buffer over Serial." alt="" coords="625,611,772,636"/>
<area shape="rect" href="classRelayEngine.html#a981b20422ed19d2aa87d042c583173ee" title="Get the relay object." alt="" coords="613,660,785,685"/>
<area shape="rect" href="classRelayEngine.html#a1ed9500ebf4f6d7afb519c377fab42d3" title="Get the number of relays." alt="" coords="616,709,781,735"/>
<area shape="rect" href="classTeleInfo.html#a4f418a8ad0164f7b10956c9186cdb345" title="Sends a telemetry value as an integer." alt="" coords="643,759,755,784"/>
<area shape="rect" href="classTeleInfo.html#ac3c9628b79d8f92c3d80dfdda4078e66" title="Initializes a new frame by resetting the buffer and adding the start character." alt="" coords="623,808,775,833"/>
<area shape="rect" href="classTeleInfo.html#a1f42b9e6aa9c3169b3ec469149e693a1" title="Calculates the checksum for a portion of the buffer." alt="" coords="843,733,1051,759"/>
<area shape="rect" href="classTeleInfo.html#aa3553828cf429c6a22eec47c1b4e0458" title="Writes a tag to the buffer." alt="" coords="879,783,1015,808"/>
</map>
</div>

</div>
</div>
<a id="gab4774b22349c58cef345ad396aecc868" name="gab4774b22349c58cef345ad396aecc868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab4774b22349c58cef345ad396aecc868">&#9670;&#160;</a></span>proceedLoadPrioritiesAndOverriding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool proceedLoadPrioritiesAndOverriding </td>
          <td>(</td>
          <td class="paramtype">const int16_t &amp;&#160;</td>
          <td class="paramname"><em>currentTemperature_x100</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles load priorities and overriding logic. </p>
<p>This function manages load priorities and overriding behavior based on the system configuration. It supports dual tariff handling, priority rotation, and manual override functionality.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentTemperature_x100</td><td>Current temperature multiplied by 100 (default to 0 if deactivated). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the system is in a high tariff (on-peak) period. </dd>
<dd>
false if the system is in a low tariff (off-peak) period.</dd></dl>
<ul>
<li>If dual tariff is enabled, it delegates to <code>proceedLoadPrioritiesAndOverridingDualTariff</code>.</li>
<li>If EmonESP control is enabled, it handles load rotation based on the rotation pin state.</li>
<li>If priority rotation is set to auto, it rotates priorities after a defined period of inactivity.</li>
<li>If the override pin is present, it forces all loads to full power when activated. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00319">319</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_cgraph" id="agroup__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_cgraph">
<area shape="rect" title="Handles load priorities and overriding logic." alt="" coords="5,25,193,65"/>
<area shape="rect" href="utils__pins_8h.html#a410a7bdd300104398ce91797bd936cdb" title="Get the Pin State." alt="" coords="493,5,591,31"/>
<area shape="rect" href="group__GeneralProcessing.html#ga2b2ee7cd0a5810e272e1ffb0b5daf0ae" title="Handles load priorities and overriding during dual tariff periods." alt="" coords="241,25,429,65"/>
<area shape="rect" href="group__GeneralProcessing.html#ga9b9428fd01019319970f27b88bb1cf33" title="Proceeds with load priority rotation." alt="" coords="477,59,607,84"/>
<area shape="rect" href="utils__pins_8h.html#abaa54130a12679d0dcc0e7578e0e4d37" title="Read the specified bit." alt="" coords="683,5,757,31"/>
<area shape="rect" href="utils_8h.html#ae473b1c0d80fe056d1fab9bdee38aca1" title="Prints the load priorities to the Serial output." alt="" coords="655,59,785,84"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_icgraph" id="agroup__GeneralProcessing_gab4774b22349c58cef345ad396aecc868_icgraph">
<area shape="rect" title="Handles load priorities and overriding logic." alt="" coords="323,5,511,45"/>
<area shape="rect" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd" title="Handles tasks that need to be executed every second." alt="" coords="104,13,275,38"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,13,56,38"/>
</map>
</div>

</div>
</div>
<a id="ga2b2ee7cd0a5810e272e1ffb0b5daf0ae" name="ga2b2ee7cd0a5810e272e1ffb0b5daf0ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2b2ee7cd0a5810e272e1ffb0b5daf0ae">&#9670;&#160;</a></span>proceedLoadPrioritiesAndOverridingDualTariff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool proceedLoadPrioritiesAndOverridingDualTariff </td>
          <td>(</td>
          <td class="paramtype">const int16_t &amp;&#160;</td>
          <td class="paramname"><em>currentTemperature_x100</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Handles load priorities and overriding during dual tariff periods. </p>
<p>This function manages load priorities and overriding logic based on the dual tariff state and the current temperature. It ensures proper load behavior during off-peak and on-peak periods.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">currentTemperature_x100</td><td>Current temperature multiplied by 100 (default to 0 if deactivated). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true if the system is in a high tariff (on-peak) period. </dd>
<dd>
false if the system is in a low tariff (off-peak) period.</dd></dl>
<ul>
<li>Detects transitions between off-peak and on-peak periods using the dual tariff pin.</li>
<li>During off-peak periods, manages load priorities and overrides based on elapsed time and temperature.</li>
<li>Logs transitions between tariff periods for debugging purposes. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00254">254</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_cgraph" id="agroup__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_cgraph">
<area shape="rect" title="Handles load priorities and overriding during dual tariff periods." alt="" coords="5,23,193,63"/>
<area shape="rect" href="utils__pins_8h.html#a410a7bdd300104398ce91797bd936cdb" title="Get the Pin State." alt="" coords="257,5,355,31"/>
<area shape="rect" href="group__GeneralProcessing.html#ga9b9428fd01019319970f27b88bb1cf33" title="Proceeds with load priority rotation." alt="" coords="241,55,371,80"/>
<area shape="rect" href="utils__pins_8h.html#abaa54130a12679d0dcc0e7578e0e4d37" title="Read the specified bit." alt="" coords="447,5,521,31"/>
<area shape="rect" href="utils_8h.html#ae473b1c0d80fe056d1fab9bdee38aca1" title="Prints the load priorities to the Serial output." alt="" coords="419,55,549,80"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_icgraph" id="agroup__GeneralProcessing_ga2b2ee7cd0a5810e272e1ffb0b5daf0ae_icgraph">
<area shape="rect" title="Handles load priorities and overriding during dual tariff periods." alt="" coords="559,5,747,45"/>
<area shape="rect" href="group__GeneralProcessing.html#gab4774b22349c58cef345ad396aecc868" title="Handles load priorities and overriding logic." alt="" coords="323,5,511,45"/>
<area shape="rect" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd" title="Handles tasks that need to be executed every second." alt="" coords="104,13,275,38"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,13,56,38"/>
</map>
</div>

</div>
</div>
<a id="ga9b9428fd01019319970f27b88bb1cf33" name="ga9b9428fd01019319970f27b88bb1cf33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9b9428fd01019319970f27b88bb1cf33">&#9670;&#160;</a></span>proceedRotation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void proceedRotation </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Proceeds with load priority rotation. </p>
<p>This function triggers the rotation of load priorities and waits until the rotation is completed. It ensures that the new load priorities are logged after the rotation.</p>
<ul>
<li>Sets the <code>b_reOrderLoads</code> flag to initiate the rotation process.</li>
<li>Waits in a loop until the rotation is completed by the ISR.</li>
<li>Logs the updated load priorities after the rotation. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00223">223</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_cgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_cgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_cgraph" id="agroup__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_cgraph">
<area shape="rect" title="Proceeds with load priority rotation." alt="" coords="5,5,135,31"/>
<area shape="rect" href="utils_8h.html#ae473b1c0d80fe056d1fab9bdee38aca1" title="Prints the load priorities to the Serial output." alt="" coords="183,5,313,31"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_icgraph" id="agroup__GeneralProcessing_ga9b9428fd01019319970f27b88bb1cf33_icgraph">
<area shape="rect" title="Proceeds with load priority rotation." alt="" coords="795,13,924,38"/>
<area shape="rect" href="group__GeneralProcessing.html#gab4774b22349c58cef345ad396aecc868" title="Handles load priorities and overriding logic." alt="" coords="323,5,511,45"/>
<area shape="rect" href="group__GeneralProcessing.html#ga2b2ee7cd0a5810e272e1ffb0b5daf0ae" title="Handles load priorities and overriding during dual tariff periods." alt="" coords="559,33,747,73"/>
<area shape="rect" href="group__GeneralProcessing.html#ga143b5ab1cc611c04c761240ce5687fdd" title="Handles tasks that need to be executed every second." alt="" coords="104,13,275,38"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,13,56,38"/>
</map>
</div>

</div>
</div>
<a id="ga09f681954987d95f85831ca82365f987" name="ga09f681954987d95f85831ca82365f987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga09f681954987d95f85831ca82365f987">&#9670;&#160;</a></span>updatePowerAndVoltageData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updatePowerAndVoltageData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates power and voltage data for all phases. </p>
<p>This function calculates the power and voltage for each phase based on the accumulated data during the datalogging period. It also updates the total power.</p>
<ul>
<li>Computes the power for each phase using the accumulated power data and calibration factors.</li>
<li>Calculates the RMS voltage for each phase using the accumulated voltage squared data.</li>
<li>Updates the total power by summing the power of all phases. </li>
</ul>

<p class="definition">Definition at line <a class="el" href="main_8cpp_source.html#l00417">417</a> of file <a class="el" href="main_8cpp_source.html">main.cpp</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group__GeneralProcessing_ga09f681954987d95f85831ca82365f987_icgraph.png" border="0" usemap="#agroup__GeneralProcessing_ga09f681954987d95f85831ca82365f987_icgraph" alt=""/></div>
<map name="agroup__GeneralProcessing_ga09f681954987d95f85831ca82365f987_icgraph" id="agroup__GeneralProcessing_ga09f681954987d95f85831ca82365f987_icgraph">
<area shape="rect" title="Updates power and voltage data for all phases." alt="" coords="104,5,316,31"/>
<area shape="rect" href="group__GeneralProcessing.html#gafe461d27b9c48d5921c00d521181f12f" title="Main processor loop." alt="" coords="5,5,56,31"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6
</small></address>
</body>
</html>
